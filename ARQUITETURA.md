# Arquitetura do Sistema - VisÃ£o TÃ©cnica

## ğŸ›ï¸ Arquitetura Geral

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    APLICAÃ‡ÃƒO ELECTRON                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           RENDERER PROCESS (Interface)              â”‚   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  index.html  â”‚  â”‚   style.css  â”‚  â”‚  JS Mods â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚          UI Layer (ui.js)                      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Renderizar views                            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Gerenciar navegaÃ§Ã£o                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Atualizar estatÃ­sticas                      â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                        â†•                              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚       Database Layer (database.js)             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Abstrair chamadas IPC                       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ MÃ©todos CRUD                                 â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Cache local                                  â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                        â†•                              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚    Auth Layer (auth.js)                        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Validar credenciais                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Gerenciar sessÃ£o                            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Controlar permissÃµes                        â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â”‚                          â†• IPC                               â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              PRELOAD SCRIPT                          â”‚   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â”‚  window.electronAPI = {                              â”‚   â”‚
â”‚  â”‚    login()                                           â”‚   â”‚
â”‚  â”‚    query()                                           â”‚   â”‚
â”‚  â”‚    execute()                                         â”‚   â”‚
â”‚  â”‚    getFuncionarios()                                 â”‚   â”‚
â”‚  â”‚    ...                                               â”‚   â”‚
â”‚  â”‚  }                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â”‚                          â†• contextBridge                     â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚            MAIN PROCESS (Backend)                    â”‚   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚          IPC Handlers                           â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ ipcMain.handle('db:query')                  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ ipcMain.handle('db:execute')                â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ ipcMain.handle('auth:login')                â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                        â†•                              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚       SQLite Manager                            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Inicializar DB                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Executar queries                             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Gerenciar transaÃ§Ãµes                         â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                        â†•                              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚         SQLite Database                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚           (database.db)                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ usuarios                                     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ funcionarios                                 â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ gaveteiros / gavetas                        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ pastas / envelopes                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ solicitacoes / retiradas                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ alertas / movimentacoes / logs              â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Fluxo de ComunicaÃ§Ã£o IPC

### Exemplo: Login de UsuÃ¡rio

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   UI Layer  â”‚         â”‚  Database   â”‚         â”‚   Preload   â”‚         â”‚    Main     â”‚
â”‚   (auth.js) â”‚         â”‚   Layer     â”‚         â”‚   Script    â”‚         â”‚   Process   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                       â”‚                        â”‚                       â”‚
       â”‚ handleLogin()         â”‚                        â”‚                       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚                       â”‚
       â”‚                       â”‚                        â”‚                       â”‚
       â”‚                       â”‚ login(user, pass)      â”‚                       â”‚
       â”‚                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚
       â”‚                       â”‚                        â”‚                       â”‚
       â”‚                       â”‚                        â”‚ ipcRenderer.invoke   â”‚
       â”‚                       â”‚                        â”‚ ('auth:login')        â”‚
       â”‚                       â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                       â”‚                        â”‚                       â”‚
       â”‚                       â”‚                        â”‚                       â”‚ SELECT FROM usuarios
       â”‚                       â”‚                        â”‚                       â”‚ WHERE username = ?
       â”‚                       â”‚                        â”‚                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                       â”‚                        â”‚                       â”‚            â”‚
       â”‚                       â”‚                        â”‚                       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                       â”‚                        â”‚                       â”‚
       â”‚                       â”‚                        â”‚ <â”€â”€â”€Promise(user)â”€â”€â”€â”€ â”‚
       â”‚                       â”‚                        â”‚                       â”‚
       â”‚                       â”‚ <â”€â”€Promise(user)â”€â”€â”€â”€â”€â”€ â”‚                       â”‚
       â”‚                       â”‚                        â”‚                       â”‚
       â”‚ <â”€â”€user dataâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚                       â”‚
       â”‚                       â”‚                        â”‚                       â”‚
       â”‚ showMainScreen()      â”‚                        â”‚                       â”‚
       â”‚                       â”‚                        â”‚                       â”‚
```

## ğŸ—‚ï¸ Estrutura de MÃ³dulos JavaScript

### 1. app.js (AplicaÃ§Ã£o Principal)
```javascript
class HospitalFileManagementApp {
  constructor() {
    this.currentUser = null;
    this.currentView = 'dashboard';
    this.db = new DatabaseLayer();
    this.auth = new AuthManager();
    this.ui = new UIManager();
  }
  
  async init() {
    await this.db.init();
    this.setupEventListeners();
    this.ui.showLoginScreen();
  }
}
```

### 2. database.js (Camada de Dados)
```javascript
class DatabaseLayer {
  async query(sql, params) {
    return await window.electronAPI.query(sql, params);
  }
  
  async getFuncionarios() {
    return await this.query('SELECT * FROM funcionarios WHERE status = ?', ['Ativo']);
  }
  
  async addGaveta(data) {
    return await window.electronAPI.execute(
      'INSERT INTO gavetas (gaveteiro_id, numero, capacidade) VALUES (?, ?, ?)',
      [data.gaveteiro_id, data.numero, data.capacidade]
    );
  }
  
  // MÃ©todos CRUD para todas entidades...
}
```

### 3. auth.js (AutenticaÃ§Ã£o)
```javascript
class AuthManager {
  async login(username, password) {
    const user = await window.electronAPI.login(username, password);
    if (user) {
      this.currentUser = user;
      return true;
    }
    return false;
  }
  
  hasPermission(action) {
    if (action === 'admin' && this.currentUser.perfil !== 'Administrador') {
      return false;
    }
    return true;
  }
}
```

### 4. ui.js (Gerenciamento de Interface)
```javascript
class UIManager {
  showLoginScreen() { /* ... */ }
  showMainScreen() { /* ... */ }
  navigateToView(view) { /* ... */ }
  openModal(title, body, footer) { /* ... */ }
  showToast(message, type) { /* ... */ }
  renderDashboard() { /* ... */ }
  renderTable(data, columns) { /* ... */ }
}
```

## ğŸ” Camadas de SeguranÃ§a

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Camada 1: Electron                    â”‚
â”‚  â€¢ nodeIntegration: false                                â”‚
â”‚  â€¢ contextIsolation: true                                â”‚
â”‚  â€¢ sandbox: true                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Camada 2: Context Bridge                    â”‚
â”‚  â€¢ API controlada e limitada                             â”‚
â”‚  â€¢ ValidaÃ§Ã£o de inputs                                   â”‚
â”‚  â€¢ SanitizaÃ§Ã£o de outputs                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Camada 3: IPC Handlers                    â”‚
â”‚  â€¢ AutenticaÃ§Ã£o de requests                              â”‚
â”‚  â€¢ Rate limiting                                         â”‚
â”‚  â€¢ ValidaÃ§Ã£o de permissÃµes                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Camada 4: Database                         â”‚
â”‚  â€¢ Prepared Statements (SQL Injection)                   â”‚
â”‚  â€¢ TransaÃ§Ãµes ACID                                       â”‚
â”‚  â€¢ Backup automÃ¡tico                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Modelo de Dados Relacional

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   usuarios   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚ 1
        â”‚
        â”‚ N
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  solicitacoes    â”‚      â”‚ funcionarios â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ 1                      â”‚ 1
        â”‚                        â”‚
        â”‚ N                      â”‚ 1
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚ retiradas_com_pessoasâ”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ 1
        â”‚
        â”‚ N
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚   alertas    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  gaveteiros  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚ 1
        â”‚
        â”‚ N
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚   gavetas    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚ 1
        â”‚
        â”‚ N
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    pastas    â”‚â—„â”€â”€â”€â”€â”€â”¤ funcionarios â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ N  1 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ 1
        â”‚
        â”‚ N
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚  envelopes   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  movimentacoes   â”‚â—„â”€â”€â”€â”€ envelopes/pastas
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Ciclo de Vida da AplicaÃ§Ã£o

```
START
  â”‚
  â”œâ”€â–º Electron inicia
  â”‚     â”‚
  â”‚     â”œâ”€â–º Cria BrowserWindow
  â”‚     â”‚     â”‚
  â”‚     â”‚     â””â”€â–º Carrega preload.js
  â”‚     â”‚           â”‚
  â”‚     â”‚           â””â”€â–º ExpÃµe API segura
  â”‚     â”‚
  â”‚     â”œâ”€â–º Inicializa SQLite
  â”‚     â”‚     â”‚
  â”‚     â”‚     â”œâ”€â–º Verifica se database.db existe
  â”‚     â”‚     â”‚     â”‚
  â”‚     â”‚     â”‚     â”œâ”€â–º [NÃƒO] Cria database.db
  â”‚     â”‚     â”‚     â”‚           â”‚
  â”‚     â”‚     â”‚     â”‚           â”œâ”€â–º Executa schema.sql
  â”‚     â”‚     â”‚     â”‚           â”‚
  â”‚     â”‚     â”‚     â”‚           â””â”€â–º Executa seeds.sql
  â”‚     â”‚     â”‚     â”‚
  â”‚     â”‚     â”‚     â””â”€â–º [SIM] Usa existente
  â”‚     â”‚     â”‚
  â”‚     â”‚     â””â”€â–º Registra IPC handlers
  â”‚     â”‚
  â”‚     â””â”€â–º Carrega index.html
  â”‚           â”‚
  â”‚           â””â”€â–º Renderiza UI
  â”‚                 â”‚
  â”‚                 â””â”€â–º App.init()
  â”‚                       â”‚
  â”‚                       â”œâ”€â–º Tela de Login
  â”‚                       â”‚
  â”‚                       â””â”€â–º [AGUARDA LOGIN]
  â”‚                             â”‚
  â”‚                             â”œâ”€â–º Login OK â†’ Dashboard
  â”‚                             â”‚
  â”‚                             â””â”€â–º Loop de eventos
  â”‚                                   â”‚
  â”‚                                   â”œâ”€â–º InteraÃ§Ãµes do usuÃ¡rio
  â”‚                                   â”œâ”€â–º AtualizaÃ§Ã£o de dados
  â”‚                                   â””â”€â–º Alertas periÃ³dicos
  â”‚
RUNNING
  â”‚
  â””â”€â–º [FECHAR JANELA] â†’ cleanup â†’ EXIT
```

## ğŸ’¾ PersistÃªncia de Dados

### LocalizaÃ§Ã£o do Banco de Dados

```
Windows: C:\Users\{usuario}\AppData\Roaming\Sistema de Arquivos Hospital\database.db
```

### EstratÃ©gia de Backup

```javascript
// Backup automÃ¡tico diÃ¡rio
setInterval(() => {
  const backupPath = path.join(app.getPath('userData'), 'backups', 
                               `backup-${Date.now()}.db`);
  fs.copyFileSync(dbPath, backupPath);
}, 24 * 60 * 60 * 1000); // 24 horas
```

## ğŸ“ˆ Performance

### OtimizaÃ§Ãµes Implementadas

1. **Ãndices de Banco**
   - Ãndices em foreign keys
   - Ãndices em campos de busca frequente
   - Ãndices compostos para queries complexas

2. **Cache em MemÃ³ria**
   - Dados do usuÃ¡rio logado
   - EstatÃ­sticas do dashboard
   - Lista de gaveteiros/gavetas

3. **Lazy Loading**
   - Carregar dados sob demanda
   - PaginaÃ§Ã£o em tabelas grandes
   - VirtualizaÃ§Ã£o de listas

4. **Prepared Statements**
   - ReutilizaÃ§Ã£o de queries compiladas
   - ProteÃ§Ã£o contra SQL injection
   - Melhor performance

## ğŸ¯ Casos de Uso Principais

### 1. Solicitar Retirada de Arquivo
```
UsuÃ¡rio â†’ Busca funcionÃ¡rio â†’ Preenche motivo â†’ Envia solicitaÃ§Ã£o
                                                      â†“
                                            Admin recebe notificaÃ§Ã£o
                                                      â†“
                                              Admin aprova/rejeita
                                                      â†“
                                    [Aprovado] â†’ Arquivo marcado como retirado
                                                      â†“
                                              Prazo de 7 dias iniciado
                                                      â†“
                                              Sistema monitora alertas
```

### 2. Gerenciar Gavetas
```
Admin â†’ Cria gaveteiro â†’ Define localizaÃ§Ã£o
                              â†“
                    Adiciona gavetas ao gaveteiro
                              â†“
                    Define capacidade (padrÃ£o 50)
                              â†“
                    Cria pastas nas gavetas
                              â†“
              Cada pasta tem 4 envelopes automÃ¡ticos
              (SeguranÃ§a, Medicina, Pessoal, Treinamento)
```

### 3. Registrar MovimentaÃ§Ã£o
```
UsuÃ¡rio â†’ Acessa pasta â†’ Visualiza envelopes
                              â†“
              Seleciona envelope â†’ Registra saÃ­da/entrada
                              â†“
                         Informa motivo
                              â†“
              Sistema registra em movimentacoes
                              â†“
                    Atualiza status do envelope
```

---

**PrÃ³ximo Passo**: Revisar este plano e aprovar para iniciar a implementaÃ§Ã£o no modo Code.